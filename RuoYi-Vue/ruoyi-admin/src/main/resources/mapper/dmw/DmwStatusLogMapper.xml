<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.dmw.mapper.DmwStatusLogMapper">

    <!-- 插入学生状态日志记录 -->
    <insert id="insertDmwStatusLog" parameterType="DmwStatusLog" useGeneratedKeys="true" keyProperty="logId">
        insert into dmw_status_log(student_id, student_name, previous_status, current_status, reason, start_date, end_date, attachment_url, create_by, create_time)
        values (#{studentId}, #{studentName}, #{previousStatus}, #{currentStatus}, #{reason}, #{startDate}, #{endDate}, #{attachmentUrl}, #{createBy}, sysdate())
    </insert>

    <select id="selectLogsByStudentId" parameterType="Long" resultType="com.ruoyi.dmw.domain.DmwStatusLog">
        select log_id, student_id, student_name, previous_status, current_status, reason, start_date, end_date, attachment_url, create_by, create_time
        from dmw_status_log
        where student_id = #{studentId}
        order by create_time desc, log_id desc
    </select>

</mapper>
